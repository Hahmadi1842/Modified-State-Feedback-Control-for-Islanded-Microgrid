clear all
close all
clc
%%
Kq2=1.0e+04 *[0.4991    0.5552    0.1103
   -0.3008    0.8637   -0.1982
    0.0676    1.0805    0.1342
    1.4837   -0.0332   -0.1275
   -0.2758    0.0442    1.0115
    0.6970   -0.9180   -0.1181
    0.3850    0.6049    0.7077
   -0.4632    0.6440   -0.8819
   -0.4295   -0.0992   -0.6020
    0.0099    1.1746    0.6853
   -1.1489    0.2259    1.5000
   -0.2264   -0.6927   -0.7005
    0.3516    0.1877   -0.2157];

Km2=Kq2';
%%
A2=[0,-1.15000000000000,0,0,0,0,0,0,0,0,0,0,0;0,0.800000000000000,0,0,0,0,0,0,0,9.12000000000000,-1.16000000000000,15.2700000000000,0;0,0,-0.800000000000000,0,0,0,0,0,0,-1.16000000000000,-9.12000000000000,0,-15.2700000000000;0,0,-1.23000000000000,0,0,0,0,0,0,-1,0,0,0;0,0,0,0,0,0,0,0,0,0,-1,0,0;0,0,-1.15000000000000,9,0,0,0,-1,0,-1.50000000000000,-150,1.75000000000000,0;0,0,0,0,9,0,0,0,-1,150,-1.50000000000000,0,1.75000000000000;0,1.25000000000000,-1.69000000000000,24,0,8.85000000000000,0,-6.05714285714286,14,-1.87000000000000,-9,4.50000000000000,0;0,-1.69000000000000,0,0,24,0,8.85000000000000,-14,-6.05714285714286,9,-1.87000000000000,0,4.50000000000000;0,1.28500000000000,0,0,0,0,0,1.20000000000000,0,0,31.4000000000000,-1.20000000000000,0;0,1.28600000000000,0,0,0,0,0,0,1.20000000000000,-31.4000000000000,0,0,-1.20000000000000;19.6215104229527,1.17000000000000,0,0,0,0,0,0,0,2.85714285714286,0,-1.28700000000000,31.4000000000000;13.0400000000000,1.19000000000000,0,0,0,0,0,0,0,0,2.85714285714286,-31.4000000000000,-1.28700000000000];
B2=[0,0,-1;0,0,0;0,0,0;0,0,0;0,0,0;0,0,0;0,0,0;0,0,0;0,0,0;0,0,0;0,0,0;-2.85713770000155,-0.00542856816238154,0;0.00542856816238154,-2.85713770000155,0];
C2=[0,-0.000150000000000000,0,0,0,0,0,0,0,0,0,0,0;1.42833739578288,0,0,0,0,0,0,0,0,0,0,0.999998195000543,-0.00189999885683354;11.4027344213486,0,0,0,0,0,0,0,0,0,0,0.00189999885683354,0.999998195000543];
D2=zeros(3,3);

Kg2=inv(-C2*((A2-B2*Km2)\B2));
sys=ss(A2-B2*Km2,B2,C2,D2);
% step(sys)

x=0*ones(13,1);
y=zeros(3,1);
ts=0.001;
t=0:001:100;
n=numel(t);
y1=zeros(1,n);
y2=zeros(1,n);
y3=zeros(1,n);
u=0.1*ones(3,1);
u1=zeros(1,n);
u2=zeros(1,n);
u3=zeros(1,n);
%
R=[1;1;1];
k=0;
for t=0:0.001:0.1
   
    k=k+1;
    
    x=x+ts*A2*x+ts*B2*u;
    y=C2*x
    
    u=-Km*x;
    y1(k)=y(1);
    y2(k)=y(1);
    y3(k)=y(1);
    
    
end
t=0:0.001:100;
plot(t,y1,'b','linewidth',2.5)
hold on
plot(t,y2,'r','linewidth',2.5)
hold on
plot(t,y3,'k','linewidth',2.5)
xlabel('time [sec]')
ylabel('output')
legend('y_1','y_2','y_3')